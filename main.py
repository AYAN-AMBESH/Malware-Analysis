import hashlib
import os

MalwareInfo = list(open("full_sha256.txt","r").read().split("\n"))
MalList  = []

def ConvertToHash(dir):
    with open(dir,"rb") as file:
        temp = file.read()
        hash = hashlib.sha256(temp).hexdigest()
        file.close()
    return hash

def MalwareCheck(dir):  
    # flag = 1
    print("scaning ",dir)
    hash = ConvertToHash(dir)
    # print("hash : ",hash)
    for i in MalwareInfo:
        if i == hash:
            # flag = -1
            MalList.append(dir)
            # print(flag)
            return 0
    return 0
#main

Directory = input("Enter a directory : ")

for root, dirs, files in os.walk(Directory, topdown=True):
    for name in files:
        MalwareCheck(os.path.join(root, name))

print(MalList)


